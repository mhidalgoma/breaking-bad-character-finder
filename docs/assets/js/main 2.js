"use strict";const charactersList=document.querySelector(".js-characters-list"),favList=document.querySelector(".js-fav-list"),searchBtn=document.querySelector(".js-search-btn"),input=document.querySelector(".js-input"),charactersSection=document.querySelector(".js-characters-section"),favSection=document.querySelector(".js-fav-section"),resetBtn=document.querySelector(".js-reset-btn");let allCharacters=[],favCharacters=[],currentSearchCharacters=[];function renderOneCharacter(e){const t=document.createElement("li");t.classList.add("character"),t.classList.add("js-character"),t.setAttribute("id",e.char_id);const a=document.createElement("div"),r=document.createElement("i");r.classList.add("fa-solid"),r.classList.add("fa-heart"),r.classList.add("fa-xl"),a.appendChild(r),a.classList.add("character__heart"),t.appendChild(a);const c=document.createElement("img");c.classList.add("character__img"),c.src=e.img,c.setAttribute("alt","image of "+e.name),t.appendChild(c);const s=document.createElement("h3");s.classList.add("character__name");const n=document.createTextNode(e.name);s.appendChild(n),t.appendChild(s);const d=document.createElement("p");d.classList.add("character__status");const i=document.createTextNode(e.status);return d.appendChild(i),t.appendChild(d),t}function renderOneFavCharacter(e){const t=document.createElement("li");t.classList.add("character"),t.classList.add("js-fav-character"),t.setAttribute("id",e.char_id);const a=document.createElement("div"),r=document.createElement("i");r.classList.add("fa-solid"),r.classList.add("fa-heart-circle-xmark"),r.classList.add("fa-xl"),a.appendChild(r),a.classList.add("character__heart--cross"),t.appendChild(a);const c=document.createElement("img");c.classList.add("character__img"),c.src=e.img,c.setAttribute("alt","image of "+e.name),t.appendChild(c);const s=document.createElement("h3");s.classList.add("character__name");const n=document.createTextNode(e.name);s.appendChild(n),t.appendChild(s);const d=document.createElement("p");d.classList.add("character__status");const i=document.createTextNode(e.status);return d.appendChild(i),t.appendChild(d),t}function renderAllCharacters(){charactersList.innerHTML="";const e=0===currentSearchCharacters.length?allCharacters:currentSearchCharacters;for(let t=0;t<e.length;t++){const a=renderOneCharacter(e[t]);charactersList.appendChild(a);-1!==favCharacters.findIndex(e=>e.char_id===parseInt(a.getAttribute("id")))&&a.classList.add("selected")}listenerForCharacters()}function renderFavCharacters(){favList.innerHTML="";for(let e=0;e<favCharacters.length;e++){const t=renderOneFavCharacter(favCharacters[e]);favList.appendChild(t)}listenerForCharactersWithHeartCross()}function listenerForCharacters(){const e=document.querySelectorAll(".js-character");for(const t of e)t.addEventListener("click",handleClickCharacter)}function listenerForCharactersWithHeartCross(){const e=document.querySelectorAll(".fa-heart-circle-xmark");for(const t of e)t.addEventListener("click",handleClickHeart)}function hideShowFavSection(){""===favList.innerHTML?(favSection.classList.add("hidden"),charactersSection.classList.add("when-hidden")):(favSection.classList.remove("hidden"),charactersSection.classList.remove("when-hidden"))}function addCharacterToFav(e){if(e.currentTarget.classList.contains("selected")){const t=allCharacters.find(t=>parseInt(t.char_id)===parseInt(e.currentTarget.getAttribute("id")));favCharacters.find(t=>parseInt(t.char_id)===parseInt(e.currentTarget.getAttribute("id")))||favCharacters.push(t)}else{const t=favCharacters.findIndex(t=>parseInt(t.char_id)===parseInt(e.currentTarget.getAttribute("id")));favCharacters.splice(t,1)}}function saveFavoritesToLocalStorage(){localStorage.setItem("Favorites",JSON.stringify(favCharacters))}function getFavoritesFromStorage(){const e=JSON.parse(localStorage.getItem("Favorites"));null!==e&&(favCharacters=e)}function handleClickCharacter(e){e.currentTarget.classList.toggle("selected"),addCharacterToFav(),renderFavCharacters(),hideShowFavSection(),saveFavoritesToLocalStorage()}function handleResetBtn(e){e.preventDefault(),favCharacters=[],renderFavCharacters(),renderAllCharacters(),hideShowFavSection(),saveFavoritesToLocalStorage()}function handleSearchBtn(e){e.preventDefault(),currentSearchCharacters=allCharacters.filter(e=>e.name.toLowerCase().includes(input.value.toLowerCase())),renderAllCharacters(),listenerForCharacters()}function handleClickHeart(e){const t=favCharacters.findIndex(t=>parseInt(t.char_id)===parseInt(e.currentTarget.closest(".js-fav-character").getAttribute("id")));console.log(t),favCharacters.splice(t,1),renderFavCharacters(),saveFavoritesToLocalStorage(),renderAllCharacters(),hideShowFavSection()}searchBtn.addEventListener("click",handleSearchBtn),resetBtn.addEventListener("click",handleResetBtn),fetch("https://breakingbadapi.com/api/characters").then(e=>e.json()).then(e=>{allCharacters=e,getFavoritesFromStorage(),renderFavCharacters(),renderAllCharacters(),hideShowFavSection()});